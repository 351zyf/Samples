<!doctype html>

<html>
  <head>
    <meta charset="utf-8">
    <link id="ppstyle" rel="stylesheet" type="text/css" href="./style.css">
    <title>PProPanel</title>

    <script src="./ext.js"></script>
    <script src="./lib/CSInterface.js"></script>
    <script src="./lib/jquery-1.9.1.js"></script>

    <script type="text/javascript">

      $( document ).ready(function() {
      	  
        $("#getseqname").on("click", function(e){
           	e.preventDefault(); 
           	var csInterface = new CSInterface();
           	csInterface.evalScript('$._ext_PPRO.getActiveSequenceName()', myCallBackFunction);  
        });

        $("#newseqfrompreset").on("click", function(e){
           	e.preventDefault(); 
           	var csInterface = new CSInterface();

           	var path = csInterface.getSystemPath(SystemPath.EXTENSION);

           	if (path != null)
           	{
           		path = path + '/payloads/PProPanel.sqpreset';
           	}

           	var pre       = '$._ext_PPRO.createSequenceFromPreset(\'';
           	var post      = '\'';
           	var postpost  = ')';

           	var whole_megillah =  pre + path + post + postpost;
           	
           	csInterface.evalScript(whole_megillah);
        });
      });

    </script>
  </head>

  <body onLoad="onLoaded()">
    <p id="version_string">[uninitialized]</p>
  	<p id="active_seq">[uninitialized]</p>
  	
      <!-- // These have JavaScript handlers... --> 

      <!-- ...the rest call directly into ExtendScript. -->

      <button class="controlBg textStyle" id="btn_PPRO14" onClick="evalScript('$._ext_PPRO.updateGrowingFile()')">Update all file references</button>
  </body>
</html>
